#Web Security
> 安全研究领域一般用黑帽子和白帽子来区分好的黑客和坏的黑客(一般称为骇客)，黑帽子即利用黑客技术实施攻击，进行网络犯罪和牟利的人群，而白帽子则是利用手中的
> 技术进行反黑客的人群。无论是哪种都应该对Web渗透有深入的了解，而白帽子做的工作要更多更复杂，因为要应对几乎所有的渗透手段。

下面参考张炳帅《Web安全深度剖析》一书总结，查看详细内容请阅读此书。

当客户端与Web服务器进行交互时就存在Web请求，这种请求都基于统一的应用层协议(HTTP协议)交互数据。想要了解Web安全，首先应该要深入理解HTTP协议。

##HTTP协议解析
HTTP(HyperText Transfer Protocol)即超文本传输协议，是一种规定了浏览器和万维网服务器之间互相通信的规则，它是万维网交换信息的基础，它允许将HTML文档从Web服务器传送到Web浏览器。

###发起HTTP请求
  当在浏览器输入一个URL，按回车键就可以发起一个HTTP请求，很快就会看到这个请求的返回结果。
  
  URL(统一资源定位符)也被称为网页地址，是互联网标准的地址。URL的标准格式为:

> 协议://服务器IP[:端口]/路径/[?查询]

  如：`http://www.xxser.com/post/httpprotocol.html`就是一个标准的URL。
  
  借助浏览器可以快速发起一次HTTP请求，如果不借助浏览器可以通过其它的工具如curl工具，在命令行使用`curl http://www.baidu..com`来返回这个页面的HTML数据，可以加上`-I`选项只返回响应头。响应头是什么下面再说，这样可以脱离浏览器发起请求，由此可见，浏览器只不过是多了HTML渲染的功能，可以让用户看到更直观的界面。
  
###HTTP协议详解
  HTTP目前的版本是1.1，它是一种无状态的协议，所谓无状态就是Web浏览器和服务器之间不需要建立了持久的连接，这意味着当一个客户端向服务器端发出请求，然后服务器返回相应连接就关闭了，服务器端不保留连接的有关信息。也就是，HTTP请求只能由客户端发起，而服务器不能主动向客户端发送数据。

  HTTP遵循请求(Request)/应答(Response)模型，下面来通过实例观察请求和相应的内容。
  
####HTTP请求
  HTTP请求包括请求行、请求头和请求正文，如下面这个例子：
  
```bash
POST /login.php HTTP/1.1                         //请求行
HOST: www.xxser.com                              //请求头
User-Agent: Mozilla/5.0 (Windows NT 6.1;rv:15.0) Gecko/20100101 Firefox/15.0
                                                 //空白行，代表请求头结束
Username=admin&password=admin                    //请求正文
```

第一行请求行有三部分组成，分别是POST请求、请求域名根目录下的login.php文件、HTTP版本号。

第二行请求头也叫消息头，HOST代表了请求主机地址，User-Agent代表浏览器的标识。

最后一行为请求正文，可选，最长出现在POST请求方法中。

####HTTP响应
  HTTP响应包括响应行、响应头(也叫消息报头)和响应正文(消息主题)，如下面这个例子：
  
```bash
HTTP/1.1 200 OK                                 //响应行
Date: Thu, 28 Feb 2013 07:36:47 GMT             //响应头
Server: BWS/1.0
Content-Length: 4199
Content-Type: text/html;charset=utf-8
Cache-Control: private 
Expires: Thu , 28 Feb 2013 07:36:47 GMT
Content-Coding: gzip
Set-Cookie: H_PS_PSSID=2022_1438_1944_1788; path=/; domain=.xxser.com
Connection: Keep-Alive
//空白行，代表响应行结束
<html>
  <head><title> Index.html </title></head>      //相应正文或者叫消息主题
  ...
```

第一行响应行有HTTP版本，状态码和消息。

第二行至末尾空白行为响应头，由服务器到客户端发送

消息报头之后是响应正文，是服务器向客户端发送的HTML数据。

####HTTP请求方法
最常见的是GET和POST请求方法。
 - GET
  GET方法以实体的形式获取请求页面的指定信息，如果请求资源为动态脚本(非HTML)，返回文本会是Web容器解析后的HTML代码，而不是源文件，
  
  请求头中可以加入参数，如：`GET /index.php?id=1 HTTP/1.1`，服务器端脚本语言可以选择接收这些参数来返回相应数据。

 - POST
  POST方法与GET方法相似，区别在于GET没有请求内容，而POST有请求内容。POST请求最多用于向服务器发送大量的数据。GET虽然也能发送数据，但是有大小长度限制，而且GET请求会将发送的参数显示在浏览器，而POST不会，所以安全性相对高些。
  
####HTTP状态码
HTTP状态码由三位数字组成，第一位数字定义了相应的类别，有以下5种：
 - 1xx：信息提示，表示请求已被成功接收，继续处理，范围100~101。
 - 2xx：成功，服务器成功处理了请求，范围200~206.如最常见的状态200。
 - 3xx：重定向，重定向状态码用于告诉浏览器客户端，访问资源已被移动，并告诉客户端新的资源地址位置。这是，浏览器将重新对新资源发起请求。范围300~305。如302就是重定向。
 - 4xx：客户端错误状态码，有时客户端会发送一些服务器无法处理的东西，比如格式错误的请求，或者最常见的是，请求一个不存的URl，范围400~415。404，请求资源不存在，400请求有语法错误，不能被理解。401，请求未经授权。403，服务器收到请求，拒绝提供服务。
 - 5xx：有时候客户端发送了一条有效请求，但web服务器自身却出错了，可能是web服务器运行出错了，或者网站都挂了，范围500~505。500，服务器内部错误，503，服务器当前不能处理客户端的请求，一段时间后可能恢复正常。
 
  
  

  
















